SpreeStoreCredits
=================

A Spree store credit implementation that applies store credit as a payment method.

Takes into account purchasing through the API, with the default to use all available store credit.

Store credit can be granted in admin, and is frozen after first usage. Store credit behaves like a credit card in that once an amount is authorized, it cannot be used elsewhere.

Store credit can be stored in multiple buckets (e.g. expiring and non-expiring) because those are taxed differently and implementors might want to prioritize use / refund different types.

Credit Types
------------

Out of the box, there are Expiring and Non-expiring store credits, with the Expiring type having top priority of being used in a purchase.

To add new ones, add a migration with a priority value set, and on purchase it will take the credits from lowest numerical priority to highest. You will also need to overwrite `Spree::StoreCredit#associate_credit_type`

Configure the gem with non-expiring categorizations in an initializer:

```ruby
Spree::StoreCredits::Configuration.set_configs(non_expiring_credit_types: ['Example'])
```


Installation
------------

Add spree_store_credits to your Gemfile:

```ruby
gem 'spree_store_credits'
```

Bundle your dependencies and run the installation generator:

```shell
bundle
bundle exec rails g spree_store_credits:install
```

Testing
-------

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

```shell
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories.
Simply add this require statement to your spec_helper:

```ruby
require 'spree_store_credits/factories'
```

TODO
----

* Integrate the frontend, this was implemented with just admin and api

Copyright (c) 2014 [Bonobos], released under the New BSD License
